require 'test/unit'
require 'asciidoctor'
require_relative '../lib/jekyll_aspec'

class TestSampleFile < Test::Unit::TestCase
	def test_convert_sample_file
  sample = "test/samples/document1.adoc"
  Asciidoctor.convert_file(sample)
  html = File.read('test/samples/document1.html')
  assert_equal("<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\">\n<!--[if IE]><meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"><![endif]-->\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<meta name=\"generator\" content=\"Asciidoctor 1.5.6.1\">\n<title>Document One</title>\n<link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700\">\n<link rel=\"stylesheet\" href=\"./asciidoctor.css\">\n</head>\n<body class=\"article\">\n<div id=\"header\">\n<h1>Document One</h1>\n</div>\n<div id=\"content\">\n<div class=\"paragraph\">\n<p>content\n</div>\n<div id=\"123\" class=\"admonitionblock requirement\">\n<table>\n<tr>\n<td class=\"icon\">\n<div class=\"title\"></div>\n</td>\n<td class=\"content\">\n<div class=\"title\">Requirement 123 Title</div>\n<div class=\"paragraph\">\n<p>\n\n    <div class=\"panel panel-primary\">\n      <div class=\"panel-heading\">\n        <h3 class=\"panel-title\">\n          <a class=\"anchor\" href=\"#123\"></a>\n          <a class=\"link\" href=\"#123\"><emphasis role=\"strong\">Requirement: 123:</emphasis> Requirement 123 Title </a> (ver. 1)\n        </h3>\n      </div>\n      <div class=\"panel-body\">\n\n</div>\n<div class=\"paragraph\">\n<p>Content of the requirement\n</div>\n<div class=\"paragraph\">\n<p>\n</div></div>\n\n</div>\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p><a href=\"#Document One\">[Document One]</a>\n</div>\n<div class=\"paragraph\">\n<p><a href=\"#Document Two\">[Document Two]</a>\n</div>\n<h2 id=\"requirements\"><a class=\"anchor\" href=\"#requirements\"></a><a class=\"link\" href=\"#requirements\">Requirements</a></h2>\n<div class=\"panel panel-default\"> <div class=\"panel-heading\"><h4>Requirements</h4></div> <table class=\"table\"><thead><tr><th>#</th>\n<th>ID</th> <th>Version</th> <th>Title</th> <th>Document</th>\n</tr></thead>\n<tbody>\n<tr> <th scope=\"row\">1</th> <td>RSL-3</td><td>1</td> <td><a class=\"link\" href=\"docs/requirement-block/index#RSL-3\"><emphasis role=\"strong\"> .title\n</emphasis>  </a></td> <td><a href=\"docs/requirement-block\"> / </a></td> </tr><tr> <th scope=\"row\">2</th> <td>RSL-3</td><td>1</td> <td><a class=\"link\" href=\"docs/requirement-block/index#RSL-3\"><emphasis role=\"strong\"> .This is the title\n</emphasis>  </a></td> <td><a href=\"docs/requirement-block\"> / </a></td> </tr><tr> <th scope=\"row\">3</th> <td>ROPR-14603</td><td>1</td> <td><a class=\"link\" href=\"docs/requirement-block/index#ROPR-14603\"><emphasis role=\"strong\">\n</emphasis>  </a></td> <td><a href=\"docs/requirement-block\"> / </a></td> </tr><tr> <th scope=\"row\">4</th> <td>123</td><td>1</td> <td><a class=\"link\" href=\"test/samples/document1/index#123\"><emphasis role=\"strong\">Requirement 123 Title\n</emphasis>  </a></td> <td><a href=\"test/samples/document1\"> / </a></td> </tr><tr> <th scope=\"row\">5</th> <td>456</td><td>1</td> <td><a class=\"link\" href=\"test/samples/subdir/document2/index#456\"><emphasis role=\"strong\">Requirement 456 Title\n</emphasis>  </a></td> <td><a href=\"test/samples/subdir/document2\">subdir / Document Two</a></td> </tr>\n</tbody></table></div>\n</div>\n<div id=\"footer\">\n<div id=\"footer-text\">\n</div>\n</div>\n</body>\n</html>", 
		html)
	end

  def test_convert_multiple
  sample = "test/samples/subdir/document2.adoc"
  Asciidoctor.convert_file(sample)
  html = File.read('test/samples/subdir/document2.html')
  assert_equal("<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\">\n<!--[if IE]><meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"><![endif]-->\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<meta name=\"generator\" content=\"Asciidoctor 1.5.6.1\">\n<title>Document Two</title>\n<link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700\">\n<link rel=\"stylesheet\" href=\"./asciidoctor.css\">\n</head>\n<body class=\"article\">\n<div id=\"header\">\n</div>\n<div id=\"content\">\n<hr>\n<div class=\"paragraph\">\n<p>chapter: subdir\ntitle: Document Two\n---\n</div>\n<h1 id=\"_document_two\" class=\"sect0\">Document Two</h1>\n<div class=\"paragraph\">\n<p>A lovely piece of text here\n</div>\n<div id=\"456\" class=\"admonitionblock requirement\">\n<table>\n<tr>\n<td class=\"icon\">\n<div class=\"title\"></div>\n</td>\n<td class=\"content\">\n<div class=\"title\">Requirement 456 Title</div>\n<div class=\"paragraph\">\n<p>\n\n    <div class=\"panel panel-primary\">\n      <div class=\"panel-heading\">\n        <h3 class=\"panel-title\">\n          <a class=\"anchor\" href=\"#456\"></a>\n          <a class=\"link\" href=\"#456\"><emphasis role=\"strong\">Requirement: 456:</emphasis> Requirement 456 Title </a> (ver. 1)\n        </h3>\n      </div>\n      <div class=\"panel-body\">\n\n</div>\n<div class=\"paragraph\">\n<p>Content of the requirement\n</div>\n<div class=\"paragraph\">\n<p>\n</div></div>\n\n</div>\n</td>\n</tr>\n</table>\n</div>\n<div class=\"paragraph\">\n<p>&lt;&lt;<strong>Req-456</strong>&gt;&gt;\n</div>\n<div class=\"paragraph\">\n<p>&lt;&lt;<strong>Req-123</strong>&gt;&gt;\n</div>\n<div class=\"sect1\">\n<h2 id=\"_section_two\">Section Two</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p><a href=\"http://www.example.com/issues/123\"><span class=\"label label-default\">123</span></a>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>See <a href=\"http://www.github.com/exampleuser/dockerfiles/blob/master/ansible/Dockerfile_template\" style=\"padding-right:2px;\">\n<span class=\"label label-info\" style=\"font-weight: 400;\nfont-size:smaller;\">\n<i class=\"fa fa-github fa-lg\"></i>\nansible/Dockerfile_template\n</span>\n</a> for more details\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<div id=\"footer\">\n<div id=\"footer-text\">\n</div>\n</div>\n</body>\n</html>", 
    html)
  end
end
